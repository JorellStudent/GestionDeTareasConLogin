(function(){"use strict";var e={4888:function(e,t,s){var r=s(5471),a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},i=[],o={name:"App"},n=o,d=s(1656),l=(0,d.A)(n,a,i,!1,null,null,null),u=l.exports,c=s(173),p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"add-task"},[t("h1",[e._v("Agregar Tarea")]),t("form",{on:{submit:function(t){return t.preventDefault(),e.addTask.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"title"}},[e._v("Título:")]),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.title,expression:"title",modifiers:{trim:!0}}],attrs:{type:"text",id:"title",placeholder:"Ingrese el título de la tarea",required:""},domProps:{value:e.title},on:{input:function(t){t.target.composing||(e.title=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"description"}},[e._v("Descripción:")]),t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.description,expression:"description",modifiers:{trim:!0}}],attrs:{id:"description",placeholder:"Ingrese la descripción de la tarea",required:""},domProps:{value:e.description},on:{input:function(t){t.target.composing||(e.description=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"due_date"}},[e._v("Fecha de Vencimiento:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.due_date,expression:"due_date"}],attrs:{type:"date",id:"due_date",required:""},domProps:{value:e.due_date},on:{input:function(t){t.target.composing||(e.due_date=t.target.value)}}}),e.due_date?t("p",[e._v(e._s(e.formattedDueDate))]):e._e()]),t("button",{attrs:{type:"submit",disabled:e.isAddingTask}},[e._v("Agregar Tarea")]),e.error?t("p",{staticClass:"error-message"},[e._v(e._s(e.error))]):e._e(),e.isAddingTask?t("p",[e._v("Registrando tarea...")]):e._e(),e.taskAddedSuccessfully?t("p",{staticClass:"success-message"},[e._v("Tarea registrada exitosamente.")]):e._e()])])},m=[],v=s(9605);const g=v.A.create({baseURL:"http://localhost:3000/api"});var f=g,h=s(5090),_={data(){return{title:"",description:"",due_date:"",error:"",isAddingTask:!1,taskAddedSuccessfully:!1}},computed:{formattedDueDate(){return this.due_date?(0,h.GP)(new Date(this.due_date),"dd/MM/yyyy"):""}},methods:{async addTask(){this.isAddingTask=!0,this.error="";try{const e=await f.post("/tasks",{title:this.title,description:this.description,due_date:this.due_date,completed:!1,user_id:1});if(201!==e.status)throw new Error("No se pudo agregar la tarea. Estado de respuesta inesperado.");this.title="",this.description="",this.due_date="",this.taskAddedSuccessfully=!0,setTimeout((()=>{this.taskAddedSuccessfully=!1}),3e3)}catch(e){console.error("Error adding task:",e),e.response&&e.response.data&&e.response.data.error?this.error=e.response.data.error:this.error="Hubo un error al agregar la tarea. Inténtalo de nuevo."}finally{this.isAddingTask=!1}}}},k=_,b=(0,d.A)(k,p,m,!1,null,"266df1c2",null),w=b.exports,y=function(){var e=this,t=e._self._c;return t("div",{staticClass:"task-list"},[t("h1",[e._v("Lista de Tareas")]),t("button",{staticClass:"action-button yellow",on:{click:e.fetchTasksFromDB}},[e._v("Cargar Tareas")]),t("div",{staticClass:"filter-controls"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.filters.name,expression:"filters.name"}],attrs:{type:"text",placeholder:"Buscar por nombre..."},domProps:{value:e.filters.name},on:{input:function(t){t.target.composing||e.$set(e.filters,"name",t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.filters.date,expression:"filters.date"}],attrs:{type:"date",placeholder:"Buscar por fecha..."},domProps:{value:e.filters.date},on:{input:function(t){t.target.composing||e.$set(e.filters,"date",t.target.value)}}}),t("label",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.filters.completed,expression:"filters.completed"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.filters.completed)?e._i(e.filters.completed,null)>-1:e.filters.completed},on:{change:function(t){var s=e.filters.completed,r=t.target,a=!!r.checked;if(Array.isArray(s)){var i=null,o=e._i(s,i);r.checked?o<0&&e.$set(e.filters,"completed",s.concat([i])):o>-1&&e.$set(e.filters,"completed",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.filters,"completed",a)}}}),e._v(" Mostrar completadas ")])]),t("ul",e._l(e.filteredTasks,(function(s){return t("li",{key:s.id,staticClass:"task-item",class:{"expired-task":e.isTaskExpired(s)}},[t("input",{attrs:{type:"checkbox"},domProps:{checked:s.completed},on:{change:function(t){return e.toggleTaskCompletion(s)}}}),s.editMode?t("div",{staticClass:"edit-mode"},[t("form",{on:{submit:function(t){return t.preventDefault(),e.saveTask(s)}}},[t("label",{attrs:{for:"edit-title"}},[e._v("Nombre:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:s.title,expression:"task.title"}],attrs:{type:"text",id:"edit-title",required:""},domProps:{value:s.title},on:{input:function(t){t.target.composing||e.$set(s,"title",t.target.value)}}}),t("label",{attrs:{for:"edit-description"}},[e._v("Descripción:")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:s.description,expression:"task.description"}],attrs:{id:"edit-description"},domProps:{value:s.description},on:{input:function(t){t.target.composing||e.$set(s,"description",t.target.value)}}}),t("label",{attrs:{for:"edit-due-date"}},[e._v("Fecha de Vencimiento:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:s.updatedDueDate,expression:"task.updatedDueDate"}],attrs:{type:"date",id:"edit-due-date",required:""},domProps:{value:s.updatedDueDate},on:{input:function(t){t.target.composing||e.$set(s,"updatedDueDate",t.target.value)}}}),t("div",{staticClass:"edit-buttons"},[t("button",{staticClass:"action-button green",attrs:{type:"submit"}},[e._v("Guardar")]),t("button",{staticClass:"action-button gray",on:{click:function(t){return e.cancelEdit(s)}}},[e._v("Cancelar")])])])]):t("div",{staticClass:"task-details"},[t("span",{class:{completed:s.completed}},[t("strong",[e._v("Nombre:")]),e._v(" "+e._s(s.title)+" "),t("br"),t("strong",[e._v("Descripción:")]),e._v(" "+e._s(s.description)+" "),t("br"),t("strong",[e._v("Fecha de Vencimiento:")]),e._v(" "+e._s(e.formatDate(s.due_date))+" ")]),t("div",{staticClass:"task-actions"},[t("button",{staticClass:"action-button green",on:{click:function(t){return e.editTask(s)}}},[e._v("Editar")]),t("button",{staticClass:"action-button red",on:{click:function(t){return e.confirmDeleteTask(s.id)}}},[e._v("Eliminar")])])]),e.isTaskExpired(s)?t("div",{staticClass:"task-status"},[t("strong",[e._v("Tarea expirada")])]):e.isExpiringSoon(s)?t("div",{staticClass:"task-status"},[t("strong",[e._v("¡Advertencia!")]),e._v(" Esta tarea expira en menos de 24 horas. ")]):e._e()])})),0)])},T=[],C={data(){return{tasks:[],filters:{name:"",date:"",completed:!1}}},computed:{filteredTasks(){let e=this.tasks.filter((e=>{if(this.filters.name&&!e.title.toLowerCase().includes(this.filters.name.toLowerCase()))return!1;if(this.filters.date){const t=new Date(e.due_date).toISOString().split("T")[0];if(t!==this.filters.date)return!1}return!(!this.filters.completed&&e.completed)}));return e}},created(){this.fetchTasksFromDB()},methods:{async fetchTasksFromDB(){try{const e=await f.get("/tasks");this.tasks=e.data.map((e=>({...e,editMode:!1,updatedDueDate:this.formatDate(e.due_date),completed:!1})))}catch(e){this.handleError("Error al obtener tareas:",e)}},async deleteTask(e){try{await f.delete(`/tasks/${e}`),this.tasks=this.tasks.filter((t=>t.id!==e))}catch(t){this.handleError("Error al eliminar tarea:",t)}},async updateTask(e){try{await f.put(`/tasks/${e.id}`,e)}catch(t){this.handleError("Error al actualizar tarea:",t)}},editTask(e){e.editMode=!0},cancelEdit(e){e.editMode=!1},async saveTask(e){try{const{title:t,description:s,updatedDueDate:r}=e;e.due_date=r,await f.put(`/tasks/${e.id}`,{title:t,description:s,due_date:r}),e.editMode=!1}catch(t){this.handleError("Error al guardar tarea:",t)}},async toggleTaskCompletion(e){try{e.completed=!e.completed,await f.put(`/tasks/${e.id}`,e)}catch(t){this.handleError("Error al actualizar estado de tarea:",t)}},confirmDeleteTask(e){confirm("¿Está seguro de que desea eliminar esta tarea?")&&this.deleteTask(e)},isExpiringSoon(e){const t=new Date,s=new Date(e.due_date),r=s-t;return r<=864e5},isTaskExpired(e){const t=new Date,s=new Date(e.due_date);return s<t},handleError(e,t){console.error(e,t),alert(`${e} Por favor, inténtelo de nuevo.`)},formatDate(e){return e?e.split("T")[0]:""}}},A=C,x=(0,d.A)(A,y,T,!1,null,"43c12ce4",null),D=x.exports,E=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-form"},[t("h2",[e._v("Iniciar sesión")]),t("form",{on:{submit:function(t){return t.preventDefault(),e.login.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"username"}},[e._v("Nombre de usuario:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",id:"username",placeholder:"Ingresa tu nombre de usuario",required:""},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"password"}},[e._v("Contraseña:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",id:"password",placeholder:"Ingresa tu contraseña",required:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e.loginError?t("p",{staticClass:"error-message"},[e._v(e._s(e.loginError))]):e._e()]),t("button",{attrs:{type:"submit"}},[e._v("Iniciar sesión")])]),t("p",[e._v("¿No estás registrado? "),t("router-link",{attrs:{to:"/register"}},[e._v("Regístrate aquí")])],1)])},L=[],N=(s(4114),{data(){return{username:"",password:"",loginError:""}},methods:{async login(){try{const e=await f.post("/auth/login",{username:this.username,password:this.password});localStorage.setItem("token",e.data.token),this.redirectToMainLayout()}catch(e){console.error("Error en inicio de sesión:",e.response.data.error),this.loginError="Nombre de usuario o contraseña incorrectos. Por favor, inténtelo de nuevo."}},redirectToMainLayout(){const e=localStorage.getItem("redirectRoute")||"AddTask";K.push({name:e}),localStorage.removeItem("redirectRoute")}}}),P=N,S=(0,d.A)(P,E,L,!1,null,"4a3f98be",null),I=S.exports,$=function(){var e=this,t=e._self._c;return t("div",{staticClass:"register-form"},[t("h2",[e._v("Registro")]),t("form",{on:{submit:function(t){return t.preventDefault(),e.register.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"username"}},[e._v("Usuario:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",id:"username",placeholder:"Ingresa tu usuario",required:""},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"password"}},[e._v("Contraseña:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",id:"password",placeholder:"Ingresa tu contraseña",required:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),t("button",{attrs:{type:"submit",disabled:e.isRegistering}},[e._v(e._s(e.registerButtonText))]),e.error?t("p",{staticClass:"error-message"},[e._v(e._s(e.error))]):e._e(),e.isRegistering?t("p",{staticClass:"registering-message"},[e._v(e._s(e.registeringMessage))]):e._e(),e.registerSuccess?t("p",{staticClass:"success-message"},[e._v("Usuario registrado exitosamente.")]):e._e()])])},M=[],R={data(){return{username:"",password:"",error:"",isRegistering:!1,registerSuccess:!1,registeringMessage:"Registrando usuario..."}},computed:{registerButtonText(){return this.isRegistering?"Registrando...":"Registrar"}},methods:{async register(){try{this.isRegistering=!0;const e=await f.post("/auth/register",{username:this.username,password:this.password});console.log(e.data),this.registerSuccess=!0,this.registeringMessage="",setTimeout((()=>{this.$router.push({name:"Login"})}),2e3)}catch(e){e.response&&e.response.data&&e.response.data.error?this.error=e.response.data.error:this.error="Error desconocido al registrar.",console.error("Error de registro:",e)}finally{setTimeout((()=>{this.isRegistering=!1}),1500)}}}},q=R,O=(0,d.A)(q,$,M,!1,null,"1e28c455",null),j=O.exports,B=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-layout"},[t("header",{staticClass:"header"},[t("nav",{staticClass:"nav-container"},[t("ul",{staticClass:"nav-list"},[t("li",[t("button",{staticClass:"nav-btn btn-add",on:{click:e.toggleAddTask}},[e._v("Agregar Tarea")])]),t("li",[t("button",{staticClass:"nav-btn btn-list",on:{click:e.toggleTaskList}},[e._v("Lista de Tareas")])]),e.isAuthenticated?t("li",[t("button",{staticClass:"nav-btn btn-logout",on:{click:e.logoutUser}},[e._v("Cerrar sesión")])]):e._e()])])]),t("main",{staticClass:"main-content"},[t("section",{directives:[{name:"show",rawName:"v-show",value:e.showAddTask,expression:"showAddTask"}]},[t("AddTask",{on:{taskAdded:e.refreshTaskList}})],1),t("section",{directives:[{name:"show",rawName:"v-show",value:e.showTaskList,expression:"showTaskList"}]},[t("TaskList",{ref:"taskList"})],1)]),e._m(0)])},F=[function(){var e=this,t=e._self._c;return t("footer",{staticClass:"footer"},[t("div",{staticClass:"footer-content"},[t("div",{staticClass:"footer-item"},[t("span",[e._v("Jorell Bermejo")]),t("br"),t("a",{attrs:{href:"mailto:j.bermejo2@alumnos.santototmas.cl"}},[e._v("Correo Institucional")])]),t("div",{staticClass:"footer-item"},[t("span",[e._v("Benjamín Naveas")]),t("br"),t("a",{attrs:{href:"mailto:b.naveas@alumnos.santotomas.cl"}},[e._v("Correo Institucional")])]),t("div",{staticClass:"footer-item"},[t("span",[e._v("Nicolás Ponce")]),t("br"),t("a",{attrs:{href:"mailto:n.ponce19@alumnos.santotomas.cl"}},[e._v("Correo Institucional")])])])])}],U={name:"MainLayout",components:{AddTask:w,TaskList:D},data(){return{isAuthenticated:!!localStorage.getItem("token"),showAddTask:!1,showTaskList:!0}},methods:{async logoutUser(){try{await f.post("/auth/logout"),localStorage.removeItem("token"),this.isAuthenticated=!1,K.push({name:"Login"})}catch(e){console.error("Error al cerrar sesión:",e),alert("Error al cerrar sesión. Por favor, inténtelo de nuevo.")}},toggleAddTask(){this.showAddTask=!0,this.showTaskList=!1},toggleTaskList(){this.showAddTask=!1,this.showTaskList=!0},refreshTaskList(){this.$refs.taskList.fetchTasks()}},watch:{isAuthenticated(e){e||K.push({name:"Login"})}},created(){this.isAuthenticated||K.push({name:"Login"})}},V=U,z=(0,d.A)(V,B,F,!1,null,"4761a755",null),G=z.exports;r.Ay.use(c.A);const H=[{path:"/",component:I,name:"Login"},{path:"/register",component:j,name:"Register"},{path:"/main",component:G,children:[{path:"add-task",component:w,name:"AddTask",meta:{requiresAuth:!0}},{path:"task-list",component:D,name:"TaskList",meta:{requiresAuth:!0}},{path:"",redirect:"add-task"}],meta:{requiresAuth:!0}},{path:"*",redirect:"/"}],J=new c.A({routes:H,mode:"history"});J.beforeEach(((e,t,s)=>{const r=!!localStorage.getItem("token");e.matched.some((e=>e.meta.requiresAuth))?r?s():s({name:"Login"}):s()}));var K=J;r.Ay.config.productionTip=!1,new r.Ay({router:K,render:e=>e(u)}).$mount("#app")}},t={};function s(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,s),i.exports}s.m=e,function(){var e=[];s.O=function(t,r,a,i){if(!r){var o=1/0;for(u=0;u<e.length;u++){r=e[u][0],a=e[u][1],i=e[u][2];for(var n=!0,d=0;d<r.length;d++)(!1&i||o>=i)&&Object.keys(s.O).every((function(e){return s.O[e](r[d])}))?r.splice(d--,1):(n=!1,i<o&&(o=i));if(n){e.splice(u--,1);var l=a();void 0!==l&&(t=l)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[r,a,i]}}(),function(){s.d=function(e,t){for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,i,o=r[0],n=r[1],d=r[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(a in n)s.o(n,a)&&(s.m[a]=n[a]);if(d)var u=d(s)}for(t&&t(r);l<o.length;l++)i=o[l],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(u)},r=self["webpackChunkclient"]=self["webpackChunkclient"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=s.O(void 0,[504],(function(){return s(4888)}));r=s.O(r)})();
//# sourceMappingURL=app.aeeeb05e.js.map